"use strict";(self["webpackChunkui"]=self["webpackChunkui"]||[]).push([[386],{9755:function(e,t,i){i.r(t),i.d(t,{default:function(){return z}});var n=i(3102),s=function(){var e=this,t=e._self._c;return t(n.Z,[t("Clients")],1)},l=[],a=i(4741),o=i(3816),r=i(5255),c=i(2393),d=i(7024),u=i(3235),h=i(1819),p=i(3182),m=i(268),v=i(7690),f=i(3240),b=i(9088),g=i(1584),S=i(1667),I=i(6849),k=i(6322),C=i(7894),x=i(3156),_=i(2515),Z=i(6818),y=i(9007),P=i(7561),D=i(5836),E=i(1811),w=i(4665),O=i(9471),$=i(8131),T=i(8219),V=i(5530),A=(0,V.Z)(D.Z,E.Z,w.Z,O.Z).extend({name:"v-tooltip",props:{closeDelay:{type:[Number,String],default:0},disabled:Boolean,openDelay:{type:[Number,String],default:0},openOnHover:{type:Boolean,default:!0},openOnFocus:{type:Boolean,default:!0},tag:{type:String,default:"span"},transition:String},data:()=>({calculatedMinWidth:0,closeDependents:!1}),computed:{calculatedLeft(){const{activator:e,content:t}=this.dimensions,i=!this.bottom&&!this.left&&!this.top&&!this.right,n=!1!==this.attach?e.offsetLeft:e.left;let s=0;return this.top||this.bottom||i?s=n+e.width/2-t.width/2:(this.left||this.right)&&(s=n+(this.right?e.width:-t.width)+(this.right?10:-10)),this.nudgeLeft&&(s-=parseInt(this.nudgeLeft)),this.nudgeRight&&(s+=parseInt(this.nudgeRight)),`${this.calcXOverflow(s,this.dimensions.content.width)}px`},calculatedTop(){const{activator:e,content:t}=this.dimensions,i=!1!==this.attach?e.offsetTop:e.top;let n=0;return this.top||this.bottom?n=i+(this.bottom?e.height:-t.height)+(this.bottom?10:-10):(this.left||this.right)&&(n=i+e.height/2-t.height/2),this.nudgeTop&&(n-=parseInt(this.nudgeTop)),this.nudgeBottom&&(n+=parseInt(this.nudgeBottom)),!1===this.attach&&(n+=this.pageYOffset),`${this.calcYOverflow(n)}px`},classes(){return{"v-tooltip--top":this.top,"v-tooltip--right":this.right,"v-tooltip--bottom":this.bottom,"v-tooltip--left":this.left,"v-tooltip--attached":""===this.attach||!0===this.attach||"attach"===this.attach}},computedTransition(){return this.transition?this.transition:this.isActive?"scale-transition":"fade-transition"},offsetY(){return this.top||this.bottom},offsetX(){return this.left||this.right},styles(){return{left:this.calculatedLeft,maxWidth:(0,$.kb)(this.maxWidth),minWidth:(0,$.kb)(this.minWidth),top:this.calculatedTop,zIndex:this.zIndex||this.activeZIndex}}},beforeMount(){this.$nextTick((()=>{this.value&&this.callActivate()}))},mounted(){"v-slot"===(0,$.sp)(this,"activator",!0)&&(0,T.N6)("v-tooltip's activator slot must be bound, try '<template #activator=\"data\"><v-btn v-on=\"data.on>'",this)},methods:{activate(){this.updateDimensions(),requestAnimationFrame(this.startTransition)},deactivate(){this.runDelay("close")},genActivatorListeners(){const e=P.Z.options.methods.genActivatorListeners.call(this);return this.openOnFocus&&(e.focus=e=>{this.getActivator(e),this.runDelay("open")},e.blur=e=>{this.getActivator(e),this.runDelay("close")}),e.keydown=e=>{e.keyCode===$.Do.esc&&(this.getActivator(e),this.runDelay("close"))},e},genActivatorAttributes(){return{"aria-haspopup":!0,"aria-expanded":String(this.isActive)}},genTransition(){const e=this.genContent();return this.computedTransition?this.$createElement("transition",{props:{name:this.computedTransition}},[e]):e},genContent(){return this.$createElement("div",this.setBackgroundColor(this.color,{staticClass:"v-tooltip__content",class:{[this.contentClass]:!0,menuable__content__active:this.isActive,"v-tooltip__content--fixed":this.activatorFixed},style:this.styles,attrs:this.getScopeIdAttrs(),directives:[{name:"show",value:this.isContentActive}],ref:"content"}),this.getContentSlot())}},render(e){return e(this.tag,{staticClass:"v-tooltip",class:this.classes},[this.showLazyContent((()=>[this.genTransition()])),this.genActivator()])}}),N=function(){var e=this,t=e._self._c;return t(h.Z,[t(o.Z,[t(r.EB,[e._v(" Clients "),t(Z.Z,{staticClass:"ml-3",attrs:{dark:"",label:e.listView?"Switch to card view":"Switch to list view"},model:{value:e.listView,callback:function(t){e.listView=t},expression:"listView"}}),t(_.Z),e.listView?t(y.Z,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}):e._e(),t(_.Z),t(a.Z,{attrs:{color:"success"},on:{click:e.startCreate}},[e._v(" Add new client "),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-account-multiple-plus-outline")])],1)],1),e.listView?t(p.Z,{attrs:{headers:e.headers,items:e.clients,search:e.search},scopedSlots:e._u([{key:"item.address",fn:function({item:i}){return e._l(i.address,(function(i,n){return t(c.Z,{key:n,attrs:{color:"indigo","text-color":"white"}},[t(b.Z,{attrs:{left:""}},[e._v("mdi-ip-network")]),e._v(" "+e._s(i)+" ")],1)}))}},{key:"item.tags",fn:function({item:i}){return e._l(i.tags,(function(i,n){return t(c.Z,{key:n,attrs:{color:"blue-grey","text-color":"white"}},[t(b.Z,{attrs:{left:""}},[e._v("mdi-tag")]),e._v(" "+e._s(i)+" ")],1)}))}},{key:"item.created",fn:function({item:i}){return[t(C.Z,[t("p",[e._v("At "+e._s(e._f("formatDate")(i.created))+" by "+e._s(i.createdBy))])])]}},{key:"item.updated",fn:function({item:i}){return[t(C.Z,[t("p",[e._v("At "+e._s(e._f("formatDate")(i.updated))+" by "+e._s(i.updatedBy))])])]}},{key:"item.action",fn:function({item:i}){return[t(C.Z,[t(b.Z,{staticClass:"pr-1 pl-1",on:{click:function(t){return t.stopPropagation(),e.startUpdate(i)}}},[e._v(" mdi-square-edit-outline ")]),t(b.Z,{staticClass:"pr-1 pl-1",on:{click:function(t){return t.stopPropagation(),e.forceFileDownload(i)}}},[e._v(" mdi-cloud-download-outline ")]),t(b.Z,{staticClass:"pr-1 pl-1",on:{click:function(t){return t.stopPropagation(),e.email(i)}}},[e._v(" mdi-email-send-outline ")]),t(b.Z,{staticClass:"pr-1 pl-1",on:{click:function(t){return e.remove(i)}}},[e._v(" mdi-trash-can-outline ")]),t(Z.Z,{staticClass:"pr-1 pl-1",attrs:{dark:"",color:"success"},on:{change:function(t){return e.update(i)}},model:{value:i.enable,callback:function(t){e.$set(i,"enable",t)},expression:"item.enable"}})],1)]}}],null,!1,1566566128)}):t(r.ZB,[t(C.Z,e._l(e.clients,(function(i,n){return t(d.Z,{key:n,attrs:{sm12:"",lg6:""}},[t(o.Z,{staticClass:"mx-auto",attrs:{color:i.enable?"#1F7087":"warning",raised:"",shaped:""}},[t(S.Z,[t(k.km,[t(k.V9,{staticClass:"headline"},[e._v(e._s(i.name))]),t(k.oZ,[e._v(e._s(i.email))]),t(k.oZ,[e._v("Created: "+e._s(e._f("formatDate")(i.created))+" by "+e._s(i.createdBy))]),t(k.oZ,[e._v("Updated: "+e._s(e._f("formatDate")(i.updated))+" by "+e._s(i.updatedBy))])],1),t(I.Z,{attrs:{tile:"",size:"150"}},[t(g.Z,{attrs:{src:"data:image/png;base64, "+e.getClientQrcode(i.id)}})],1)],1),t(r.ZB,{staticClass:"text--primary"},e._l(i.address,(function(i,n){return t(c.Z,{key:n,attrs:{color:"indigo","text-color":"white"}},[t(b.Z,{attrs:{left:""}},[e._v("mdi-ip-network")]),e._v(" "+e._s(i)+" ")],1)})),1),t(r.ZB,{staticClass:"text--primary"},e._l(i.tags,(function(i,n){return t(c.Z,{key:n,attrs:{color:"blue-grey","text-color":"white"}},[t(b.Z,{attrs:{left:""}},[e._v("mdi-tag")]),e._v(" "+e._s(i)+" ")],1)})),1),t(r.h7,[t(A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[t(a.Z,e._g({attrs:{text:""},on:{click:function(t){return e.forceFileDownload(i)}}},n),[t("span",{staticClass:"d-none d-lg-flex"},[e._v("Download")]),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-cloud-download-outline")])],1)]}}],null,!0)},[t("span",[e._v("Download")])]),t(A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[t(a.Z,e._g({attrs:{text:""},on:{click:function(t){return t.stopPropagation(),e.startUpdate(i)}}},n),[t("span",{staticClass:"d-none d-lg-flex"},[e._v("Edit")]),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-square-edit-outline")])],1)]}}],null,!0)},[t("span",[e._v("Edit")])]),t(A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[t(a.Z,e._g({attrs:{text:""},on:{click:function(t){return e.remove(i)}}},n),[t("span",{staticClass:"d-none d-lg-flex"},[e._v("Delete")]),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-trash-can-outline")])],1)]}}],null,!0)},[t("span",[e._v("Delete")])]),t(A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[t(a.Z,e._g({attrs:{text:""},on:{click:function(t){return e.email(i)}}},n),[t("span",{staticClass:"d-none d-lg-flex"},[e._v("Send Email")]),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-email-send-outline")])],1)]}}],null,!0)},[t("span",[e._v("Send Email")])]),t(_.Z),t(A,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:n}){return[t(Z.Z,e._g({attrs:{dark:"",color:"success"},on:{change:function(t){return e.update(i)}},model:{value:i.enable,callback:function(t){e.$set(i,"enable",t)},expression:"client.enable"}},n))]}}],null,!0)},[t("span",[e._v(" "+e._s(i.enable?"Disable":"Enable")+" this client")])])],1)],1)],1)})),1)],1)],1),e.client?t(m.Z,{attrs:{"max-width":"550"},model:{value:e.dialogCreate,callback:function(t){e.dialogCreate=t},expression:"dialogCreate"}},[t(o.Z,[t(r.EB,{staticClass:"headline"},[e._v("Add new client")]),t(r.ZB,[t(C.Z,[t(d.Z,{attrs:{cols:"12"}},[t(f.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(y.Z,{attrs:{label:"Client friendly name",rules:[e=>!!e||"Client name is required"],required:""},model:{value:e.client.name,callback:function(t){e.$set(e.client,"name",t)},expression:"client.name"}}),t(y.Z,{attrs:{label:"Client email",rules:[e=>/.+@.+\..+/.test(e)||""===e||"E-mail must be valid"]},model:{value:e.client.email,callback:function(t){e.$set(e.client,"email",t)},expression:"client.email"}}),t(x.Z,{attrs:{items:e.server.address,label:"Client IP will be chosen from these networks",rules:[e=>!!e||"Network is required"],multiple:"",chips:"","persistent-hint":"",required:""},model:{value:e.client.address,callback:function(t){e.$set(e.client,"address",t)},expression:"client.address"}}),t(u.Z,{attrs:{chips:"",hint:"Write IPv4 or IPv6 CIDR and hit enter",label:"Allowed IPs",multiple:"",dark:""},scopedSlots:e._u([{key:"selection",fn:function({attrs:i,item:n,select:s,selected:l}){return[t(c.Z,e._b({attrs:{"input-value":l,close:""},on:{click:s,"click:close":function(t){e.client.allowedIPs.splice(e.client.allowedIPs.indexOf(n),1)}}},"v-chip",i,!1),[t("strong",[e._v(e._s(n))]),e._v("  ")])]}}],null,!1,1095272819),model:{value:e.client.allowedIPs,callback:function(t){e.$set(e.client,"allowedIPs",t)},expression:"client.allowedIPs"}}),t(u.Z,{attrs:{chips:"",hint:"Write tag name and hit enter",label:"Tags",multiple:"",dark:""},scopedSlots:e._u([{key:"selection",fn:function({attrs:i,item:n,select:s,selected:l}){return[t(c.Z,e._b({attrs:{"input-value":l,close:""},on:{click:s,"click:close":function(t){e.client.tags.splice(e.client.tags.indexOf(n),1)}}},"v-chip",i,!1),[t("strong",[e._v(e._s(n))]),e._v("  ")])]}}],null,!1,4170403475),model:{value:e.client.tags,callback:function(t){e.$set(e.client,"tags",t)},expression:"client.tags"}}),t(Z.Z,{attrs:{color:"red",inset:"",label:e.client.enable?"Enable client after creation":"Disable client after creation"},model:{value:e.client.enable,callback:function(t){e.$set(e.client,"enable",t)},expression:"client.enable"}}),t(Z.Z,{attrs:{color:"red",inset:"",label:"Ignore global persistent keepalive: "+(e.client.ignorePersistentKeepalive?"Yes":"NO")},on:{change:e.handlePersistentKeepaliveChange},model:{value:e.client.ignorePersistentKeepalive,callback:function(t){e.$set(e.client,"ignorePersistentKeepalive",t)},expression:"client.ignorePersistentKeepalive"}}),e.client.ignorePersistentKeepalive?[t(Z.Z,{attrs:{color:"red",inset:"",label:"Persist Keepalive Disabled: "+(e.client.keepaliveDisabled?"Yes":"NO")},on:{change:e.handleKeepaliveDisabledChange},model:{value:e.client.keepaliveDisabled,callback:function(t){e.$set(e.client,"keepaliveDisabled",t)},expression:"client.keepaliveDisabled"}}),e.client.keepaliveDisabled?e._e():t(y.Z,{attrs:{label:"Persist Keepalive Interval",type:"number",min:"1",rules:[t=>!(e.client.ignorePersistentKeepalive&&!e.client.keepaliveDisabled)||!!t||"Keepalive interval is required when keepalive is enabled",t=>!(e.client.ignorePersistentKeepalive&&!e.client.keepaliveDisabled)||t>0||"Interval must be greater than 0"],hint:"Interval in seconds","persistent-hint":""},model:{value:e.client.keepaliveInterval,callback:function(t){e.$set(e.client,"keepaliveInterval",e._n(t))},expression:"client.keepaliveInterval"}})]:e._e(),t(Z.Z,{attrs:{color:"green",inset:"",label:"Use server DNS: "+(e.client.useRemoteDNS?"Yes":"NO")},model:{value:e.client.useRemoteDNS,callback:function(t){e.$set(e.client,"useRemoteDNS",t)},expression:"client.useRemoteDNS"}}),t(Z.Z,{attrs:{color:"red",inset:"",label:"Site-to-Site Client: "+(e.client.site2site?"Yes":"NO")},on:{change:e.handleSite2SiteChange},model:{value:e.client.site2site,callback:function(t){e.$set(e.client,"site2site",t)},expression:"client.site2site"}}),e.client.site2site?[t(u.Z,{attrs:{chips:"",hint:"Client side LAN subnets to route over VPN",label:"Client LAN IP's",multiple:"",dark:"",rules:[e=>!!e||"LAN IPs are required when Site-to-Site is enabled"]},scopedSlots:e._u([{key:"selection",fn:function({attrs:i,item:n,select:s,selected:l}){return[t(c.Z,e._b({attrs:{"input-value":l,close:""},on:{click:s,"click:close":function(t){e.client.lanIPs.splice(e.client.lanIPs.indexOf(n),1)}}},"v-chip",i,!1),[t("strong",[e._v(e._s(n))]),e._v("  ")])]}}],null,!1,4071570579),model:{value:e.client.lanIPs,callback:function(t){e.$set(e.client,"lanIPs",t)},expression:"client.lanIPs"}}),t(x.Z,{attrs:{items:e.tableOptions,label:"WireGuard routing table",hint:"Optionally define routing table to use for Wireguard, or leave as AUTO (Default) or OFF to disable automatic creation of routes","persistent-hint":"","return-object":!1,"menu-props":{closeOnContentClick:!1}},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[t(S.Z,[t(y.Z,{attrs:{label:"Custom table value (integer)",type:"number"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setCustomTableValue.apply(null,arguments)}},model:{value:e.customTableValue,callback:function(t){e.customTableValue=t},expression:"customTableValue"}}),t(a.Z,{staticClass:"ml-2",attrs:{small:"",color:"primary"},on:{click:e.setCustomTableValue}},[e._v(" Apply ")])],1),t(v.Z)]},proxy:!0}],null,!1,3173498189),model:{value:e.client.table,callback:function(t){e.$set(e.client,"table",t)},expression:"client.table"}}),t(Z.Z,{attrs:{color:"blue",inset:"",label:"Enable Endpoint Options: "+(e.client.Site2SiteEndpointOptionsEnabled?"Yes":"No")},on:{change:e.handleEnableEndpointOptionsChange},model:{value:e.client.Site2SiteEndpointOptionsEnabled,callback:function(t){e.$set(e.client,"Site2SiteEndpointOptionsEnabled",t)},expression:"client.Site2SiteEndpointOptionsEnabled"}}),e.client.Site2SiteEndpointOptionsEnabled?[t(y.Z,{attrs:{label:"Client endpoint address",hint:"IP address or URL of client endpoint if open to internet","persistent-hint":""},model:{value:e.client.Site2SiteEndpoint,callback:function(t){e.$set(e.client,"Site2SiteEndpoint",t)},expression:"client.Site2SiteEndpoint"}}),t(y.Z,{attrs:{label:"Client endpoint listen port",type:"number",hint:"Listen port to use if client open to internet","persistent-hint":"",rules:[t=>!e.client.Site2SiteEndpoint||!!t||"Listen port is required if endpoint is set"]},model:{value:e.client.Site2SiteEndpointListenPort,callback:function(t){e.$set(e.client,"Site2SiteEndpointListenPort",e._n(t))},expression:"client.Site2SiteEndpointListenPort"}}),t(y.Z,{attrs:{label:"Client endpoint public port",type:"number",hint:"Public port for client endpoint if DNAT is being used","persistent-hint":"",rules:[t=>!e.client.Site2SiteEndpoint||!t||t>0||"Public port must be a positive integer"]},on:{input:function(t){return e.validatePortInput(t,"Site2SiteEndpointPort")}},model:{value:e.client.Site2SiteEndpointPort,callback:function(t){e.$set(e.client,"Site2SiteEndpointPort",e._n(t))},expression:"client.Site2SiteEndpointPort"}})]:e._e()]:e._e()],2)],1)],1)],1),t(r.h7,[t(_.Z),t(a.Z,{attrs:{disabled:!e.valid,color:"success"},on:{click:function(t){return e.create(e.client)}}},[e._v(" Submit "),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-check-outline")])],1),t(a.Z,{attrs:{color:"primary"},on:{click:function(t){e.dialogCreate=!1}}},[e._v(" Cancel "),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-close-circle-outline")])],1)],1)],1)],1):e._e(),e.client?t(m.Z,{attrs:{"max-width":"550"},model:{value:e.dialogUpdate,callback:function(t){e.dialogUpdate=t},expression:"dialogUpdate"}},[t(o.Z,[t(r.EB,{staticClass:"headline"},[e._v("Edit client")]),t(r.ZB,[t(C.Z,[t(d.Z,{attrs:{cols:"12"}},[t(f.Z,{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(y.Z,{attrs:{label:"Friendly name",rules:[e=>!!e||"Client name is required"],required:""},model:{value:e.client.name,callback:function(t){e.$set(e.client,"name",t)},expression:"client.name"}}),t(y.Z,{attrs:{label:"Email",rules:[e=>/.+@.+\..+/.test(e)||""===e||"E-mail must be valid"],required:""},model:{value:e.client.email,callback:function(t){e.$set(e.client,"email",t)},expression:"client.email"}}),t(u.Z,{attrs:{chips:"",hint:"Write IPv4 or IPv6 CIDR and hit enter",label:"Addresses",multiple:"",dark:""},scopedSlots:e._u([{key:"selection",fn:function({attrs:i,item:n,select:s,selected:l}){return[t(c.Z,e._b({attrs:{"input-value":l,close:""},on:{click:s,"click:close":function(t){e.client.address.splice(e.client.address.indexOf(n),1)}}},"v-chip",i,!1),[t("strong",[e._v(e._s(n))]),e._v("  ")])]}}],null,!1,3626235027),model:{value:e.client.address,callback:function(t){e.$set(e.client,"address",t)},expression:"client.address"}}),t(u.Z,{attrs:{chips:"",hint:"Write IPv4 or IPv6 CIDR and hit enter",label:"Allowed IPs",multiple:"",dark:""},scopedSlots:e._u([{key:"selection",fn:function({attrs:i,item:n,select:s,selected:l}){return[t(c.Z,e._b({attrs:{"input-value":l,close:""},on:{click:s,"click:close":function(t){e.client.allowedIPs.splice(e.client.allowedIPs.indexOf(n),1)}}},"v-chip",i,!1),[t("strong",[e._v(e._s(n))]),e._v("  ")])]}}],null,!1,1095272819),model:{value:e.client.allowedIPs,callback:function(t){e.$set(e.client,"allowedIPs",t)},expression:"client.allowedIPs"}}),t(u.Z,{attrs:{chips:"",hint:"Write tag name and hit enter",label:"Tags",multiple:"",dark:""},scopedSlots:e._u([{key:"selection",fn:function({attrs:i,item:n,select:s,selected:l}){return[t(c.Z,e._b({attrs:{"input-value":l,close:""},on:{click:s,"click:close":function(t){e.client.tags.splice(e.client.tags.indexOf(n),1)}}},"v-chip",i,!1),[t("strong",[e._v(e._s(n))]),e._v("  ")])]}}],null,!1,4170403475),model:{value:e.client.tags,callback:function(t){e.$set(e.client,"tags",t)},expression:"client.tags"}}),t(Z.Z,{attrs:{color:"red",inset:"",label:"Ignore global persistent keepalive: "+(e.client.ignorePersistentKeepalive?"Yes":"NO")},on:{change:e.handlePersistentKeepaliveChange},model:{value:e.client.ignorePersistentKeepalive,callback:function(t){e.$set(e.client,"ignorePersistentKeepalive",t)},expression:"client.ignorePersistentKeepalive"}}),e.client.ignorePersistentKeepalive?[t(Z.Z,{attrs:{color:"red",inset:"",label:"Persist Keepalive Disabled: "+(e.client.keepaliveDisabled?"Yes":"NO")},on:{change:e.handleKeepaliveDisabledChange},model:{value:e.client.keepaliveDisabled,callback:function(t){e.$set(e.client,"keepaliveDisabled",t)},expression:"client.keepaliveDisabled"}}),e.client.keepaliveDisabled?e._e():t(y.Z,{attrs:{label:"Persist Keepalive Interval",type:"number",min:"1",rules:[t=>!(e.client.ignorePersistentKeepalive&&!e.client.keepaliveDisabled)||!!t||"Keepalive interval is required when keepalive is enabled",t=>!(e.client.ignorePersistentKeepalive&&!e.client.keepaliveDisabled)||t>0||"Interval must be greater than 0"],hint:"Interval in seconds","persistent-hint":""},model:{value:e.client.keepaliveInterval,callback:function(t){e.$set(e.client,"keepaliveInterval",e._n(t))},expression:"client.keepaliveInterval"}})]:e._e(),t(Z.Z,{attrs:{color:"green",inset:"",label:"Use server DNS: "+(e.client.useRemoteDNS?"Yes":"NO")},model:{value:e.client.useRemoteDNS,callback:function(t){e.$set(e.client,"useRemoteDNS",t)},expression:"client.useRemoteDNS"}}),t(Z.Z,{attrs:{color:"red",inset:"",label:"Site-to-Site Client: "+(e.client.site2site?"Yes":"NO")},on:{change:e.handleSite2SiteChange},model:{value:e.client.site2site,callback:function(t){e.$set(e.client,"site2site",t)},expression:"client.site2site"}}),e.client.site2site?[t(u.Z,{attrs:{chips:"",hint:"Client side LAN subnets to route over VPN",label:"Client LAN IP's",multiple:"",dark:"",rules:[e=>!!e||"LAN IPs are required when Site-to-Site is enabled"]},scopedSlots:e._u([{key:"selection",fn:function({attrs:i,item:n,select:s,selected:l}){return[t(c.Z,e._b({attrs:{"input-value":l,close:""},on:{click:s,"click:close":function(t){e.client.lanIPs.splice(e.client.lanIPs.indexOf(n),1)}}},"v-chip",i,!1),[t("strong",[e._v(e._s(n))]),e._v("  ")])]}}],null,!1,4071570579),model:{value:e.client.lanIPs,callback:function(t){e.$set(e.client,"lanIPs",t)},expression:"client.lanIPs"}}),t(x.Z,{attrs:{items:e.tableOptions,label:"WireGuard routing table",hint:"Optionally define routing table to use for Wireguard, or leave as AUTO (Default) or OFF to disable automatic creation of routes","persistent-hint":"","return-object":!1,"menu-props":{closeOnContentClick:!1}},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[t(S.Z,[t(y.Z,{attrs:{label:"Custom table value (integer)",type:"number"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setCustomTableValue.apply(null,arguments)}},model:{value:e.customTableValue,callback:function(t){e.customTableValue=t},expression:"customTableValue"}}),t(a.Z,{staticClass:"ml-2",attrs:{small:"",color:"primary"},on:{click:e.setCustomTableValue}},[e._v(" Apply ")])],1),t(v.Z)]},proxy:!0}],null,!1,3173498189),model:{value:e.client.table,callback:function(t){e.$set(e.client,"table",t)},expression:"client.table"}}),t(Z.Z,{attrs:{color:"blue",inset:"",label:"Enable Endpoint Options: "+(e.client.Site2SiteEndpointOptionsEnabled?"Yes":"No")},on:{change:e.handleEnableEndpointOptionsChange},model:{value:e.client.Site2SiteEndpointOptionsEnabled,callback:function(t){e.$set(e.client,"Site2SiteEndpointOptionsEnabled",t)},expression:"client.Site2SiteEndpointOptionsEnabled"}}),e.client.Site2SiteEndpointOptionsEnabled?[t(y.Z,{attrs:{label:"Client endpoint address",hint:"IP address or URL of client endpoint if open to internet","persistent-hint":""},model:{value:e.client.Site2SiteEndpoint,callback:function(t){e.$set(e.client,"Site2SiteEndpoint",t)},expression:"client.Site2SiteEndpoint"}}),t(y.Z,{attrs:{label:"Client endpoint listen port",type:"number",hint:"Listen port to use if client open to internet","persistent-hint":"",rules:[t=>!e.client.Site2SiteEndpoint||!!t||"Listen port is required if endpoint is set"]},model:{value:e.client.Site2SiteEndpointListenPort,callback:function(t){e.$set(e.client,"Site2SiteEndpointListenPort",e._n(t))},expression:"client.Site2SiteEndpointListenPort"}}),t(y.Z,{attrs:{label:"Client endpoint public port",type:"number",hint:"Public port for client endpoint if DNAT is being used","persistent-hint":"",rules:[t=>!e.client.Site2SiteEndpoint||!t||t>0||"Public port must be a positive integer"]},on:{input:function(t){return e.validatePortInput(t,"Site2SiteEndpointPort")}},model:{value:e.client.Site2SiteEndpointPort,callback:function(t){e.$set(e.client,"Site2SiteEndpointPort",e._n(t))},expression:"client.Site2SiteEndpointPort"}})]:e._e()]:e._e()],2)],1)],1)],1),t(r.h7,[t(_.Z),t(a.Z,{attrs:{disabled:!e.valid,color:"success"},on:{click:function(t){return e.update(e.client)}}},[e._v(" Submit "),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-check-outline")])],1),t(a.Z,{attrs:{color:"primary"},on:{click:function(t){e.dialogUpdate=!1}}},[e._v(" Cancel "),t(b.Z,{attrs:{right:"",dark:""}},[e._v("mdi-close-circle-outline")])],1)],1)],1)],1):e._e()],1)},L=[],K=i(629),F={name:"Clients",data:()=>({listView:!1,dialogCreate:!1,dialogUpdate:!1,client:null,valid:!1,search:"",customTableValue:"",headers:[{text:"Name",value:"name"},{text:"Email",value:"email"},{text:"IP addresses",value:"address"},{text:"Tags",value:"tags"},{text:"Created",value:"created",sortable:!1},{text:"Updated",value:"updated",sortable:!1},{text:"Actions",value:"action",sortable:!1}]}),computed:{...(0,K.Se)({getClientQrcode:"client/getClientQrcode",getClientConfig:"client/getClientConfig",server:"server/server",clients:"client/clients",clientQrcodes:"client/clientQrcodes"}),tableOptions(){return["auto","off"].concat("number"===typeof this.client?.table||this.client?.table&&!isNaN(Number(this.client.table))&&"auto"!==this.client.table&&"off"!==this.client.table?[this.client.table.toString()]:[])},showEndpointOptions(){return!!this.client.Site2SiteEndpoint}},mounted(){this.readAllClients(),this.readServer()},methods:{...(0,K.nv)("client",{errorClient:"error",readAllClients:"readAll",creatClient:"create",updateClient:"update",deleteClient:"delete",emailClient:"email"}),...(0,K.nv)("server",{readServer:"read"}),startCreate(){this.client={name:"",email:"",enable:!0,allowedIPs:this.server.allowedips,address:this.server.address,tags:[],ignorePersistentKeepalive:!1,keepaliveDisabled:!1,keepaliveInterval:0,useRemoteDNS:!1,site2site:!1,lanIPs:[],Site2SiteEndpoint:"",Site2SiteEndpointListenPort:null,Site2SiteEndpointPort:null,table:"auto",Site2SiteEndpointOptionsEnabled:!1},this.dialogCreate=!0},create(e){if(e.allowedIPs.length<1)this.errorClient("Please provide at least one valid CIDR address for client allowed IPs");else{for(let t=0;t<e.allowedIPs.length;t++)if(0===this.$isCidr(e.allowedIPs[t]))return void this.errorClient("Invalid CIDR detected, please correct before submitting");if(e.address.length<1)this.errorClient("Please provide at least one valid CIDR address for client");else{for(let t=0;t<e.address.length;t++)if(0===this.$isCidr(e.address[t]))return void this.errorClient("Invalid CIDR detected, please correct before submitting");if(!e.ignorePersistentKeepalive||e.keepaliveDisabled||e.keepaliveInterval&&!(e.keepaliveInterval<=0)){if(e.site2site){if(0===e.lanIPs.length)return void this.errorClient("LAN IPs are required when Site-to-Site is enabled");if(e.Site2SiteEndpointOptionsEnabled){if(e.Site2SiteEndpoint&&!e.Site2SiteEndpointListenPort)return void this.errorClient("Listen port is required if endpoint is set");if(e.Site2SiteEndpoint&&e.Site2SiteEndpointPort&&e.Site2SiteEndpointPort<=0)return void this.errorClient("Public port must be a positive integer")}}this.dialogCreate=!1,this.creatClient(e)}else this.errorClient("Keepalive interval must be set when keepalive is enabled")}}},remove(e){confirm(`Do you really want to delete ${e.name} ?`)&&this.deleteClient(e)},email(e){e.email?confirm(`Do you really want to send email to ${e.email} with all configurations ?`)&&this.emailClient(e):this.errorClient("Client email is not defined")},startUpdate(e){this.client={...e},void 0!==e.table&&null!==e.table?this.client.table=e.table.toString():this.client.table="auto",this.client.Site2SiteEndpoint=e.Site2SiteEndpoint||"",this.client.Site2SiteEndpointListenPort=e.Site2SiteEndpointListenPort||null,this.client.Site2SiteEndpointPort=e.Site2SiteEndpointPort||null,this.client.Site2SiteEndpointOptionsEnabled=e.Site2SiteEndpointOptionsEnabled||!1,this.dialogUpdate=!0},update(e){if(e.allowedIPs.length<1)this.errorClient("Please provide at least one valid CIDR address for client allowed IPs");else{for(let t=0;t<e.allowedIPs.length;t++)if(0===this.$isCidr(e.allowedIPs[t]))return void this.errorClient("Invalid CIDR detected, please correct before submitting");if(e.address.length<1)this.errorClient("Please provide at least one valid CIDR address for client");else{for(let t=0;t<e.address.length;t++)if(0===this.$isCidr(e.address[t]))return void this.errorClient("Invalid CIDR detected, please correct before submitting");if(!e.ignorePersistentKeepalive||e.keepaliveDisabled||e.keepaliveInterval&&!(e.keepaliveInterval<=0)){if(e.site2site){if(0===e.lanIPs.length)return void this.errorClient("LAN IPs are required when Site-to-Site is enabled");if(e.Site2SiteEndpointOptionsEnabled){if(e.Site2SiteEndpoint&&!e.Site2SiteEndpointListenPort)return void this.errorClient("Listen port is required if endpoint is set");if(e.Site2SiteEndpoint&&e.Site2SiteEndpointPort&&e.Site2SiteEndpointPort<=0)return void this.errorClient("Public port must be a positive integer")}}this.dialogUpdate=!1,this.updateClient(e)}else this.errorClient("Keepalive interval must be set when keepalive is enabled")}}},forceFileDownload(e){let t=this.getClientConfig(e.id);if(!t)return void this.errorClient("Failed to download client config");const i=window.URL.createObjectURL(new Blob([t])),n=document.createElement("a");n.href=i,n.setAttribute("download",this.getConfigFileName(e)),document.body.appendChild(n),n.click()},getConfigFileName(e){let t=e.name.split(" ").join("-");return t=t.replace(/[^a-zA-Z\d_-]+/g,""),t+".conf"},handlePersistentKeepaliveChange(){this.client.ignorePersistentKeepalive||(this.client.keepaliveDisabled=!1,this.client.keepaliveInterval=0)},handleKeepaliveDisabledChange(){this.client.keepaliveDisabled&&(this.client.keepaliveInterval=0)},handleSite2SiteChange(){this.client.site2site||(this.client.lanIPs=[],this.client.Site2SiteEndpoint="",this.client.Site2SiteEndpointListenPort=null,this.client.Site2SiteEndpointPort=null,this.client.table="auto",this.client.Site2SiteEndpointOptionsEnabled=!1)},setCustomTableValue(){if(""!==this.customTableValue&&!isNaN(this.customTableValue)){const e=parseInt(this.customTableValue,10);this.client.table=e.toString(),this.customTableValue=""}},handleEnableEndpointOptionsChange(){this.client.Site2SiteEndpointOptionsEnabled||(this.client.Site2SiteEndpoint="",this.client.Site2SiteEndpointListenPort=null,this.client.Site2SiteEndpointPort=null)},validatePortInput(e,t){""===e.target.value||isNaN(e.target.value)?this.client[t]=null:this.client[t]=parseInt(e.target.value,10)}}},R=F,B=i(1001),q=(0,B.Z)(R,N,L,!1,null,null,null),U=q.exports,M={name:"clients",components:{Clients:U}},W=M,Y=(0,B.Z)(W,s,l,!1,null,null,null),z=Y.exports},3235:function(e,t,i){i.d(t,{Z:function(){return c}});var n=i(3156),s=i(9007),l=i(7559),a=i(8131);const o={...n.l,offsetY:!0,offsetOverflow:!0,transition:!1};var r=n.Z.extend({name:"v-autocomplete",props:{autoSelectFirst:{type:Boolean,default:!1},filter:{type:Function,default:(e,t,i)=>i.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())>-1},hideNoData:Boolean,menuProps:{type:n.Z.options.props.menuProps.type,default:()=>o},noFilter:Boolean,searchInput:{type:String}},data(){return{lazySearch:this.searchInput}},computed:{classes(){return{...n.Z.options.computed.classes.call(this),"v-autocomplete":!0,"v-autocomplete--is-selecting-index":this.selectedIndex>-1}},computedItems(){return this.filteredItems},selectedValues(){return this.selectedItems.map((e=>this.getValue(e)))},hasDisplayedItems(){return this.hideSelected?this.filteredItems.some((e=>!this.hasItem(e))):this.filteredItems.length>0},currentRange(){return null==this.selectedItem?0:String(this.getText(this.selectedItem)).length},filteredItems(){return!this.isSearching||this.noFilter||null==this.internalSearch?this.allItems:this.allItems.filter((e=>{const t=(0,a.qF)(e,this.itemText),i=null!=t?String(t):"";return this.filter(e,String(this.internalSearch),i)}))},internalSearch:{get(){return this.lazySearch},set(e){this.lazySearch!==e&&(this.lazySearch=e,this.$emit("update:search-input",e))}},isAnyValueAllowed(){return!1},isDirty(){return this.searchIsDirty||this.selectedItems.length>0},isSearching(){return this.multiple&&this.searchIsDirty||this.searchIsDirty&&this.internalSearch!==this.getText(this.selectedItem)},menuCanShow(){return!!this.isFocused&&(this.hasDisplayedItems||!this.hideNoData)},$_menuProps(){const e=n.Z.options.computed.$_menuProps.call(this);return e.contentClass=`v-autocomplete__content ${e.contentClass||""}`.trim(),{...o,...e}},searchIsDirty(){return null!=this.internalSearch&&""!==this.internalSearch},selectedItem(){return this.multiple?null:this.selectedItems.find((e=>this.valueComparator(this.getValue(e),this.getValue(this.internalValue))))},listData(){const e=n.Z.options.computed.listData.call(this);return e.props={...e.props,items:this.virtualizedItems,noFilter:this.noFilter||!this.isSearching||!this.filteredItems.length,searchInput:this.internalSearch},e}},watch:{filteredItems:"onFilteredItemsChanged",internalValue:"setSearch",isFocused(e){e?(document.addEventListener("copy",this.onCopy),this.$refs.input&&this.$refs.input.select()):(document.removeEventListener("copy",this.onCopy),this.blur(),this.updateSelf())},isMenuActive(e){!e&&this.hasSlot&&(this.lazySearch=null)},items(e,t){t&&t.length||!this.hideNoData||!this.isFocused||this.isMenuActive||!e.length||this.activateMenu()},searchInput(e){this.lazySearch=e},internalSearch:"onInternalSearchChanged",itemText:"updateSelf"},created(){this.setSearch()},destroyed(){document.removeEventListener("copy",this.onCopy)},methods:{onFilteredItemsChanged(e,t){if(e!==t){if(!this.autoSelectFirst){const i=t[this.$refs.menu.listIndex];i?this.setMenuIndex(e.findIndex((e=>e===i))):this.setMenuIndex(-1),this.$emit("update:list-index",this.$refs.menu.listIndex)}this.$nextTick((()=>{this.internalSearch&&(1===e.length||this.autoSelectFirst)&&(this.$refs.menu.getTiles(),this.autoSelectFirst&&e.length&&(this.setMenuIndex(0),this.$emit("update:list-index",this.$refs.menu.listIndex)))}))}},onInternalSearchChanged(){this.updateMenuDimensions()},updateMenuDimensions(){this.isMenuActive&&this.$refs.menu&&this.$refs.menu.updateDimensions()},changeSelectedIndex(e){this.searchIsDirty||(this.multiple&&e===a.Do.left?-1===this.selectedIndex?this.selectedIndex=this.selectedItems.length-1:this.selectedIndex--:this.multiple&&e===a.Do.right?this.selectedIndex>=this.selectedItems.length-1?this.selectedIndex=-1:this.selectedIndex++:e!==a.Do.backspace&&e!==a.Do["delete"]||this.deleteCurrentItem())},deleteCurrentItem(){const e=this.selectedIndex,t=this.selectedItems[e];if(!this.isInteractive||this.getDisabled(t))return;const i=this.selectedItems.length-1;if(-1===this.selectedIndex&&0!==i)return void(this.selectedIndex=i);const n=this.selectedItems.length,s=e!==n-1?e:e-1,l=this.selectedItems[s];l?this.selectItem(t):this.setValue(this.multiple?[]:null),this.selectedIndex=s},clearableCallback(){this.internalSearch=null,n.Z.options.methods.clearableCallback.call(this)},genInput(){const e=s.Z.options.methods.genInput.call(this);return e.data=(0,l.ZP)(e.data,{attrs:{"aria-activedescendant":(0,a.vO)(this.$refs.menu,"activeTile.id"),autocomplete:(0,a.vO)(e.data,"attrs.autocomplete","off")},domProps:{value:this.internalSearch}}),e},genInputSlot(){const e=n.Z.options.methods.genInputSlot.call(this);return e.data.attrs.role="combobox",e},genSelections(){return this.hasSlot||this.multiple?n.Z.options.methods.genSelections.call(this):[]},onClick(e){this.isInteractive&&(this.selectedIndex>-1?this.selectedIndex=-1:this.onFocus(),this.isAppendInner(e.target)||this.activateMenu())},onInput(e){if(this.selectedIndex>-1||!e.target)return;const t=e.target,i=t.value;t.value&&this.activateMenu(),this.multiple||""!==i||this.deleteCurrentItem(),this.internalSearch=i,this.badInput=t.validity&&t.validity.badInput},onKeyDown(e){const t=e.keyCode;!e.ctrlKey&&[a.Do.home,a.Do.end].includes(t)||n.Z.options.methods.onKeyDown.call(this,e),this.changeSelectedIndex(t)},onSpaceDown(e){},onTabDown(e){n.Z.options.methods.onTabDown.call(this,e),this.updateSelf()},onUpDown(e){e.preventDefault(),this.activateMenu()},selectItem(e){n.Z.options.methods.selectItem.call(this,e),this.setSearch()},setSelectedItems(){n.Z.options.methods.setSelectedItems.call(this),this.isFocused||this.setSearch()},setSearch(){this.$nextTick((()=>{this.multiple&&this.internalSearch&&this.isMenuActive||(this.internalSearch=!this.selectedItems.length||this.multiple||this.hasSlot?null:this.getText(this.selectedItem))}))},updateSelf(){(this.searchIsDirty||this.internalValue)&&(this.multiple||this.valueComparator(this.internalSearch,this.getValue(this.internalValue))||this.setSearch())},hasItem(e){return this.selectedValues.indexOf(this.getValue(e))>-1},onCopy(e){var t,i;if(-1===this.selectedIndex)return;const n=this.selectedItems[this.selectedIndex],s=this.getText(n);null===(t=e.clipboardData)||void 0===t||t.setData("text/plain",s),null===(i=e.clipboardData)||void 0===i||i.setData("text/vnd.vuetify.autocomplete.item+plain",s),e.preventDefault()}}}),c=r.extend({name:"v-combobox",props:{delimiters:{type:Array,default:()=>[]},returnObject:{type:Boolean,default:!0}},data:()=>({editingIndex:-1}),computed:{computedCounterValue(){return this.multiple?this.selectedItems.length:(this.internalSearch||"").toString().length},hasSlot(){return n.Z.options.computed.hasSlot.call(this)||this.multiple},isAnyValueAllowed(){return!0},menuCanShow(){return!!this.isFocused&&(this.hasDisplayedItems||!!this.$slots["no-data"]&&!this.hideNoData)},searchIsDirty(){return null!=this.internalSearch}},methods:{onInternalSearchChanged(e){if(e&&this.multiple&&this.delimiters.length){const t=this.delimiters.find((t=>e.endsWith(t)));null!=t&&(this.internalSearch=e.slice(0,e.length-t.length),this.updateTags())}this.updateMenuDimensions()},genInput(){const e=r.options.methods.genInput.call(this);return delete e.data.attrs.name,e.data.on.paste=this.onPaste,e},genChipSelection(e,t){const i=n.Z.options.methods.genChipSelection.call(this,e,t);return this.multiple&&(i.componentOptions.listeners={...i.componentOptions.listeners,dblclick:()=>{this.editingIndex=t,this.internalSearch=this.getText(e),this.selectedIndex=-1}}),i},onChipInput(e){n.Z.options.methods.onChipInput.call(this,e),this.editingIndex=-1},onEnterDown(e){e.preventDefault(),this.getMenuIndex()>-1||this.$nextTick(this.updateSelf)},onKeyDown(e){const t=e.keyCode;!e.ctrlKey&&[a.Do.home,a.Do.end].includes(t)||n.Z.options.methods.onKeyDown.call(this,e),this.multiple&&t===a.Do.left&&0===this.$refs.input.selectionStart?this.updateSelf():t===a.Do.enter&&this.onEnterDown(e),this.changeSelectedIndex(t)},onTabDown(e){if(this.multiple&&this.internalSearch&&-1===this.getMenuIndex())return e.preventDefault(),e.stopPropagation(),this.updateTags();r.options.methods.onTabDown.call(this,e)},selectItem(e){this.editingIndex>-1?this.updateEditing():(r.options.methods.selectItem.call(this,e),this.internalSearch&&this.multiple&&this.getText(e).toLocaleLowerCase().includes(this.internalSearch.toLocaleLowerCase())&&(this.internalSearch=null))},setSelectedItems(){null==this.internalValue||""===this.internalValue?this.selectedItems=[]:this.selectedItems=this.multiple?this.internalValue:[this.internalValue]},setValue(e){n.Z.options.methods.setValue.call(this,void 0===e?this.internalSearch:e)},updateEditing(){const e=this.internalValue.slice(),t=this.selectedItems.findIndex((e=>this.getText(e)===this.internalSearch));if(t>-1){const i="object"===typeof e[t]?Object.assign({},e[t]):e[t];e.splice(t,1),e.push(i)}else e[this.editingIndex]=this.internalSearch;this.setValue(e),this.editingIndex=-1,this.internalSearch=null},updateCombobox(){if(!this.searchIsDirty)return;this.internalSearch!==this.getText(this.internalValue)&&this.setValue();const e=Boolean(this.$scopedSlots.selection)||this.hasChips;e&&(this.internalSearch=null)},updateSelf(){this.multiple?this.updateTags():this.updateCombobox()},updateTags(){const e=this.getMenuIndex();if(e<0&&!this.searchIsDirty||!this.internalSearch)return;if(this.editingIndex>-1)return this.updateEditing();const t=this.selectedItems.findIndex((e=>this.internalSearch===this.getText(e))),i=t>-1&&"object"===typeof this.selectedItems[t]?Object.assign({},this.selectedItems[t]):this.internalSearch;if(t>-1){const e=this.internalValue.slice();e.splice(t,1),this.setValue(e)}if(e>-1)return this.internalSearch=null;this.selectItem(i),this.internalSearch=null},onPaste(e){var t;if(this.$emit("paste",e),!this.multiple||this.searchIsDirty)return;const i=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text/vnd.vuetify.autocomplete.item+plain");i&&-1===this.findExistingIndex(i)&&(e.preventDefault(),n.Z.options.methods.selectItem.call(this,i))},clearableCallback(){this.editingIndex=-1,r.options.methods.clearableCallback.call(this)}}})}}]);
//# sourceMappingURL=Clients-legacy.7c1c4e84.js.map